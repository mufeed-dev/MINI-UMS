<%- include('../layouts/header.ejs') %>

<div class="password-reset-page">
  <div class="password-reset-container">
    <h1>Reset Password</h1>

    <form action="" method="post">
      <div class="form-group">
        <input
          type="password"
          name="password"
          id="password"
          class="password-input"
          placeholder="Enter new password"
          required
          minlength="8"
          oninput="checkPasswordStrength(this.value)"
        />
        <div class="password-strength">
          <div class="strength-meter" id="strengthMeter"></div>
        </div>
        <div class="password-requirements">
          Password must be at least 8 characters long and include uppercase,
          lowercase, and numbers.
        </div>
      </div>

      <input type="hidden" name="user_id" value="<%= user_id %>" />

      <button type="submit" class="submit-btn">Reset Password</button>
    </form>
  </div>
</div>

<script>
  function checkPasswordStrength(password) {
    const meter = document.getElementById("strengthMeter");
    let strength = 0;

    // Check length
    if (password.length >= 8) strength += 1;
    if (password.length >= 12) strength += 1;

    // Check for mixed case
    if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 1;

    // Check for numbers
    if (/\d/.test(password)) strength += 1;

    // Check for special characters
    if (/[^a-zA-Z0-9]/.test(password)) strength += 1;

    // Update meter
    const width = strength * 20;
    let color = "#e74c3c"; // red

    if (strength >= 3) color = "#f39c12"; // orange
    if (strength >= 4) color = "#2ecc71"; // green

    meter.style.width = width + "%";
    meter.style.background = color;
  }
</script>

<%- include('../layouts/footer.ejs') %>
